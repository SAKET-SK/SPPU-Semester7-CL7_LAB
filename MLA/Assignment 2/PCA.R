R version 4.1.0 (2021-05-18) -- "Camp Pontanezen"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Workspace loaded from ~/.RData]

> getwd()
[1] "C:/Users/Saket/Documents"
> data("iris")
> str(iris)
'data.frame':	150 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
> set.seed(111)
> ind<- sample(2,nrow(iris),replace =TRUE, prob = c(0.8,0.2))
> training<- iris[ind==1,]
> testing<- iris[ind==2,]
> library(psych)
> # the above statement requires psych library to be installed
> pairs.panels(training[,-5], gap=0, bg=c("red","green" , "blue")[training$Species], pch=21)
> 
> pr<- prcomp(training[,-5],center =TRUE ,scale. =TRUE)
> 
> 
> attributes(pr)
$names
[1] "sdev"     "rotation" "center"   "scale"    "x"       

$class
[1] "prcomp"

> pr$center
Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
    5.790000     3.069167     3.597500     1.111667 
> pr$scale
Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
   0.8234382    0.4588615    1.7872782    0.7556158 
> print(pr)
Standard deviations (1, .., p=4):
[1] 1.7173318 0.9403519 0.3843232 0.1371332

Rotation (n x k) = (4 x 4):
                    PC1         PC2        PC3        PC4
Sepal.Length  0.5147163 -0.39817685  0.7242679  0.2279438
Sepal.Width  -0.2926048 -0.91328503 -0.2557463 -0.1220110
Petal.Length  0.5772530 -0.02932037 -0.1755427 -0.7969342
Petal.Width   0.5623421 -0.08065952 -0.6158040  0.5459403
> summary(pr)
Importance of components:
                          PC1    PC2     PC3    PC4
Standard deviation     1.7173 0.9404 0.38432 0.1371
Proportion of Variance 0.7373 0.2211 0.03693 0.0047
Cumulative Proportion  0.7373 0.9584 0.99530 1.0000
> pairs.panels(pr$x, gap=0,bg=c("red","blue","green")[training$Species],pch=21)
> library(devtools)
Loading required package: usethis
> library(ggbiplot)
Loading required package: ggplot2

Attaching package: ‘ggplot2’

The following objects are masked from ‘package:psych’:

    %+%, alpha

Loading required package: plyr
Loading required package: scales

Attaching package: ‘scales’

The following objects are masked from ‘package:psych’:

    alpha, rescale

Loading required package: grid
> g<- ggbiplot(pr,obs.scale = 1,var.scale = 1,groups = training$Species,ellipse = TRUE,circle = TRUE,ellipse.prob = 0.68)
> g<- g+ scale_color_discrete(name='') 
> g<- g+theme(legend.direction = "horizontal",legend.position = "top")
> trg<- predict(pc,training)
Error in predict(pc, training) : object 'pc' not found
> trg<- predict(pr,training)
> trg
           PC1          PC2           PC3           PC4
1   -2.0942621 -0.390479892  0.1117895752  0.0155964510
2   -1.9004407  0.701394964  0.2145512665  0.0931822321
3   -2.1852900  0.401680656 -0.0630099904  0.0292277018
4   -2.1194349  0.645787862 -0.1148751719 -0.0610428409
5   -2.2205378 -0.541157297 -0.0319019490 -0.0386754453
6   -1.9160708 -1.357948199 -0.0397399215  0.0030168844
7   -2.2686138  0.039655263 -0.3537552466 -0.0239723433
8   -2.0607048 -0.144732182  0.0697461852 -0.0300848294
9   -2.1492140  1.142204792 -0.1694965776 -0.0186376148
10  -2.0063320  0.511396324  0.2304914899 -0.0502480219
11  -2.0019748 -0.935252226  0.2543675423  0.0008731820
12  -2.1534233 -0.049661878 -0.1159887290 -0.1300380062
13  -2.0373705  0.760425041  0.2080916828 -0.0067507777
14  -2.4468051  1.007123571 -0.2022257498 -0.0113927767
15  -2.0401384 -1.720850758  0.4684542738  0.1655989805
16  -2.1119798 -2.494897451 -0.0349014685  0.0422915851
17  -2.0452623 -1.351386184 -0.0004527557  0.1813739337
19  -1.7392003 -1.293306927  0.3613617031  0.0404016425
20  -2.1788452 -0.999893498 -0.1467340823 -0.0365115761
21  -1.7460763 -0.341434804  0.4019288479 -0.0085355253
22  -2.0406559 -0.811535362 -0.1724960972  0.0623294156
23  -2.5997621 -0.341173667 -0.3444410287  0.0289537752
24  -1.6465682 -0.029359804 -0.0506968065  0.1517617000
26  -1.7733367  0.649758553  0.2828642450  0.0316856647
27  -1.8795636 -0.167722033 -0.1030695616  0.0698280134
28  -1.9994560 -0.440475799  0.1899243452 -0.0013108542
29  -1.9679863 -0.239802486  0.2554810995  0.0698683473
30  -2.0883964  0.396759145 -0.0924753648 -0.1045400851
31  -1.9621206  0.547436550  0.0512161594 -0.0502681888
32  -1.6618287 -0.359503144  0.2585784755  0.2251451046
33  -2.4564831 -1.623997983 -0.0629884540 -0.2331015414
34  -2.2906023 -1.977131174  0.0734710811 -0.0598052940
35  -1.9319103  0.500721651  0.1489945123  0.0220030307
36  -2.0300634  0.258254949  0.2106814852  0.1568628357
37  -1.8765272 -0.582261002  0.4734376123  0.1709135421
38  -2.3574677 -0.482127220 -0.0383615327 -0.1386084551
39  -2.2452795  0.944812486 -0.2154097490 -0.0006382916
41  -2.1146465 -0.351158658 -0.0478421724  0.1047548087
42  -1.6619766  2.279012076  0.1811945744  0.2854242920
43  -2.3728146  0.546746867 -0.3268796746 -0.0538181698
45  -1.9752320 -1.017130186 -0.2675182258 -0.1426175728
46  -1.8885271  0.739075694  0.0450977275  0.1377513275
47  -2.2209690 -0.990859328 -0.0750588961 -0.1533518910
49  -2.0644830 -0.886896822  0.1664109810 -0.0268087752
50  -2.0292352  0.055941131  0.1353029395  0.0410943720
51   1.2435865 -0.894366840  0.6480862801  0.0168904297
52   0.8783633 -0.611628084  0.0584935170  0.0122282637
53   1.3838633 -0.660934308  0.5147241210 -0.0011290605
54   0.5793649  1.644417702 -0.0193979576  0.0808443073
56   0.5470329  0.544340327 -0.1712686062 -0.2196877854
57   0.8911050 -0.776261171 -0.1863385678 -0.0589711046
58  -0.3088020  1.779024861 -0.2896288156 -0.0164656965
59   1.0781369 -0.091531619  0.5547836921 -0.0417293721
61   0.0733722  2.523519689  0.0016240141  0.0283974925
62   0.5964639  0.033136065 -0.2403539900  0.0607661429
63   0.7324083  1.633697513  0.7206107452  0.0290908746
64   0.8723155  0.137930222  0.0236821160 -0.1524773678
66   1.0229359 -0.545346308  0.4694169331  0.0942022842
67   0.5058330  0.173280765 -0.5336890485 -0.1560475157
68   0.3208520  0.733603769  0.2562010169 -0.2038119977
69   1.3910226  1.475410820  0.4399300223  0.2227637404
70   0.3331967  1.220986530  0.1299044249 -0.0445664566
72   0.6355762  0.359121232  0.2296665967  0.1139863550
73   1.3914196  0.823394972  0.3213945295 -0.0076811690
74   0.7872397  0.358312378  0.2424110342 -0.2703895339
75   0.8562269  0.010100699  0.4083359437  0.0366745005
76   1.0241952 -0.297958095  0.4371953345  0.0931102661
77   1.4059383 -0.003165298  0.6852912171  0.0232970094
79   0.8196333  0.178891960 -0.1261278401 -0.0187297477
80   0.1283241  0.990835005  0.2829101670  0.0626315582
81   0.3021582  1.470015247  0.1075046178 -0.0010692123
83   0.4050997  0.715535430  0.1128506444  0.0298686322
84   1.2153774  0.556439883 -0.1550856409 -0.1608343909
85   0.3808166  0.269991572 -0.7096021713 -0.2114114301
86   0.5752172 -0.826946762 -0.4862996319 -0.0794283907
87   1.1942512 -0.560942493  0.3584545811  0.0326855498
88   1.2086219  1.251012457  0.6449673677  0.1239429156
89   0.2277981  0.201192127 -0.3314079274 -0.1221925716
90   0.4518298  1.246352083 -0.1308678832  0.0276644291
91   0.4428321  1.051431931 -0.1443930342 -0.2495336119
93   0.5011651  0.912927735  0.1587638158  0.0118693090
94  -0.1825263  1.929702267 -0.1459372914  0.0378061998
95   0.4513986  0.796650052 -0.1740248304 -0.0870120166
96   0.2481824  0.161870893 -0.1717761798 -0.2113509293
98   0.7312105  0.106811507  0.2324228209 -0.0186894139
101  1.9807727 -0.893659782 -1.0474946558  0.0116279586
102  1.3136261  0.621126669 -0.5754896967  0.0005548526
104  1.5856996 -0.016243814 -0.2147887950 -0.2094126039
106  2.8807823 -0.892325930  0.5302026928 -0.1052765648
107  0.5359569  1.485583292 -1.0337041196 -0.0723694153
108  2.4368666 -0.511281377  0.5960242788 -0.2447178682
109  2.1553983  0.583184802  0.3403337189 -0.0815035433
111  1.5067673 -0.723199878 -0.3199655587  0.1336299100
112  1.7532710  0.327713240 -0.0673939113  0.0774680711
116  1.7321199 -0.710149502 -0.6720566360  0.2335225860
117  1.6146505 -0.310346927 -0.0847888436 -0.1360493663
119  3.4440978 -0.170820954  0.6486397757  0.0394994671
120  1.4274956  1.563919108  0.2149079423 -0.0555464856
121  2.1738524 -0.958488536 -0.2715609949  0.1935753227
122  1.1346681  0.511411001 -0.8689911771  0.0800305763
124  1.4871496  0.393305332 -0.0345663292  0.1558921106
125  1.8362250 -1.039461191 -0.3402151251 -0.0328806360
126  2.0861621 -1.055102891  0.3703282033 -0.2184018557
130  2.0002581 -0.632406917  0.6644356672 -0.2205455581
131  2.5729683 -0.367997637  0.6778624082 -0.0290163946
132  2.4191489 -2.615698937  0.4493332350 -0.2180227341
133  2.0096621  0.091734898 -0.3970851815  0.1338635028
135  1.3542991  0.720264116  0.1024908813 -0.4740109114
136  2.9306445 -0.953828162  0.5042742561  0.2898538092
137  1.7133920 -1.075455903 -0.9824454751  0.0911440162
138  1.4883748 -0.461024333 -0.2284803678 -0.1903212626
140  1.9918829 -0.733184868 -0.0233667023  0.2094309436
143  1.3136261  0.621126669 -0.5754896967  0.0005548526
144  2.1759399 -0.913414140 -0.3791611392  0.0767148408
145  2.1339118 -1.082159885 -0.6662030358  0.2561235744
146  2.0148817 -0.455509590 -0.2868952348  0.4143375981
147  1.7214043  0.779055774 -0.0144151727  0.2367337791
148  1.6666003 -0.326774763 -0.2183174245  0.1422205259
149  1.5118663 -1.013144818 -0.9692614759  0.0803895310
150  1.1104099 -0.013652490 -0.5732410461 -0.1237840602
> tst<- predict(pr,testing)
> tst<- data.frame(tst, testing[5])
> library(nnet)
> mymodel<- multinom(Species~PC1+PC2, data=trg)
Error in model.frame.default(formula = Species ~ PC1 + PC2, data = trg) : 
  'data' must be a data.frame, not a matrix or an array
> summary(mymodel)
Error in summary(mymodel) : object 'mymodel' not found
> mymodel<- multinom(Species~PC1+PC2, data.frame=trg)
Error in eval(predvars, data, env) : object 'Species' not found